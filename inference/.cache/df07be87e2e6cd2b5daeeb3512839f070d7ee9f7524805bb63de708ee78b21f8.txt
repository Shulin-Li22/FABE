import os
import io
import logging
from string_util import arxivid2filename

LATEX_DOCUMENT_DIR = "/path/to/latex/documents"
logger = logging.getLogger(__name__)

def save(arxiv_id, input_stream, encoding):
    filename = arxivid2filename(arxiv_id, "tex")
    try:
        with io.TextIOWrapper(io.FileIO(os.path.join(LATEX_DOCUMENT_DIR, filename), "w"), encoding=encoding) as writer:
            writer.write(input_stream.read())
            writer.flush()
    except IOError as e:
        logger.error(f"Failed to save the Latex source with id='{arxiv_id}'", e)
        raise RuntimeError(e)
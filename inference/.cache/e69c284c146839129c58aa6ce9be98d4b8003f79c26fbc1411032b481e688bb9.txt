import hashlib
from org.eclipse.swt.widgets import MessageDialog
from org.eclipse.swt.widgets import PasswordDialog
from org.eclipse.swt.widgets import Shell
from org.eclipse.ui.PartInitException
from org.eclipse.ui.PlatformUI
from java.math import BigInteger

def execute(event):
    try:
        shell = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell()
        view = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getActivePage().showView("org.rcpquizengine.views.quizzes")
        rootFolder = view.getRootFolder()
        if not rootFolder.isEncrypted():
            dialog = PasswordDialog(shell)
            if dialog.open() == Window.OK:
                password = dialog.getPassword()
                if password != "":
                    md5 = hashlib.md5(password.encode()).hexdigest()
                    rootFolder.setMd5Digest(md5)
                    rootFolder.setEncrypted(True)
                    MessageDialog.openInformation(shell, "Quiz bank locked", "The current quiz bank has been locked")
                    password = ""
                    md5 = ""
        else:
            MessageDialog.openError(shell, "Error locking quiz bank", "Quiz bank already locked")
    except PartInitException:
        e.printStackTrace()
    except NoSuchAlgorithmException:
        e.printStackTrace()
    return None